# 📂 VoiceFast Agent Output Guide

## 🎯 Output Structure

When you run the agent with `npm run run`, it now:

1. **Displays results in the terminal** - Full JSON output
2. **Saves JSON file** - Machine-readable format in `output/` directory
3. **Saves Markdown report** - Human-readable format in `output/` directory

## 📁 Output Directory

```
output/
├── agent-output-2025-01-15T10-30-45-123Z.json    # Timestamped JSON output
├── agent-report-2025-01-15T10-30-45-123Z.md      # Timestamped Markdown report
├── agent-output-2025-01-15T11-22-10-456Z.json
└── agent-report-2025-01-15T11-22-10-456Z.md
```

**Note:** The `output/` directory is automatically created on first run and is ignored by git.

## 📊 JSON Output Format

```json
{
  "contact_details": {
    "contact_name": "Sarah Johnson",
    "contact_handle": "+1-555-0123",
    "contact_platform": "whatsapp",
    "company": "TechStart Inc",
    "problems": [...],
    "constraints": {...},
    "priorities": [...],
    "research_items": [...],
    "report_markdown": "..."
  },
  "search_prompt": "Generated search query...",
  "web_search_results": "Search results...",
  "full_report": {
    // Structured data for easy access
  }
}
```

## 📄 Markdown Report Contents

The markdown report includes:

- 📝 **Original Input** - The conversation transcript
- 👤 **Contact Information** - Name, handle, platform, company
- 🚨 **Problems Identified** - Numbered list of all issues
- 📋 **Constraints** - Budget, deadline, team size, tech stack
- 🎯 **Priorities** - Ranked by impact and effort
- 🔍 **Research Items** - Recommended solutions with URLs
- 📊 **Search Prompt** - Generated search query
- 🌐 **Web Search Results** - AI findings
- 📝 **Full Report** - Complete analysis in markdown

## 🔄 Accessing Outputs Programmatically

### Read the JSON output:

```typescript
import * as fs from 'fs';

const outputPath = './output/agent-output-2025-01-15T10-30-45-123Z.json';
const data = JSON.parse(fs.readFileSync(outputPath, 'utf-8'));

console.log(data.full_report.problems);
// ["Customer support overwhelmed...", "No feedback tracking system...", ...]

console.log(data.contact_details.contact_name);
// "Sarah Johnson"
```

### In Python (for integration with main.py):

```python
import json
from pathlib import Path

output_file = Path("output/agent-output-2025-01-15T10-30-45-123Z.json")
with open(output_file) as f:
    data = json.load(f)

problems = data['full_report']['problems']
contact_name = data['contact_details']['contact_name']
```

## 🔗 Integration with VoiceFast Voice API

Example integration flow:

1. **User talks** → VoiceFast records transcript
2. **Transcript** → Send to agent via `runWorkflow()`
3. **Agent processes** → Returns structured data
4. **Save to output/** → Both JSON and Markdown
5. **Use results** → Send WhatsApp message, update CRM, etc.

### Example FastAPI Integration:

```python
# In main.py, add:
import subprocess
import json

@app.post("/process-conversation")
async def process_conversation(transcript: str):
    """Process a conversation transcript through the agent"""
    
    # Run the TypeScript agent
    result = subprocess.run(
        ['npm', 'run', 'run', '--', transcript],
        capture_output=True,
        text=True
    )
    
    # Read the latest output file
    output_dir = Path("output")
    latest_json = max(output_dir.glob("agent-output-*.json"))
    
    with open(latest_json) as f:
        agent_results = json.load(f)
    
    return {
        "status": "success",
        "contact": agent_results["contact_details"]["contact_name"],
        "problems_count": len(agent_results["full_report"]["problems"]),
        "output_file": str(latest_json)
    }
```

## 📈 Output Files Management

### List all output files:

```bash
ls -lt output/
```

### View latest JSON output:

```bash
cat output/$(ls -t output/agent-output-*.json | head -1) | jq
```

### View latest Markdown report:

```bash
cat output/$(ls -t output/agent-report-*.md | head -1)
```

### Clean up old outputs:

```bash
# Keep only last 10 outputs
cd output
ls -t agent-output-*.json | tail -n +11 | xargs rm -f
ls -t agent-report-*.md | tail -n +11 | xargs rm -f
```

## 💡 Tips

- **Timestamped files** prevent overwrites - every run creates a new file
- **JSON for machines** - Easy to parse and process programmatically
- **Markdown for humans** - Easy to read, share, and review
- **Git ignored** - Output directory won't be committed to version control

---

*Generated by VoiceFast Agent Setup*

